<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Bug Report</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="/static/css/style.css?v=6">
</head>
<body>
    <div class="top-buttons" id="top-buttons">
        <button class="top-btn" id="my-reports-btn" onclick="switchPage('my-reports')">–ú–æ–∏ —Ä–µ–ø–æ—Ä—Ç—ã</button>
        <button class="top-btn" id="admin-btn" style="display: none;" onclick="switchPage('admin')">–ê–¥–º–∏–Ω–∫–∞</button>
    </div>

    <div id="upload-overlay" class="upload-overlay">
        <div class="upload-modal">
            <h3 id="upload-title">–ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤</h3>
            <div id="upload-stage" class="upload-stage">–≠—Ç–∞–ø 1 –∏–∑ 2: –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä</div>
            <div class="progress-bar">
                <div id="progress-bar-fill" class="progress-bar-fill"></div>
            </div>
            <div id="progress-text" class="progress-text">0%</div>
            <div id="upload-hint" class="upload-hint"></div>
        </div>
    </div>

    <div id="page-form" class="page active">
        <h1>Bug Report</h1>

        <div id="error-message" class="error-message"></div>
        <div id="success-message" class="success-message">
            <h2>–û—Ç—á—ë—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω!</h2>
            <p>–û–∫–Ω–æ –∑–∞–∫—Ä–æ–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏...</p>
        </div>

        <form id="bug-form">
            <div class="form-group">
                <label class="required">–í–∞—à –ª–æ–≥–∏–Ω</label>
                <input type="text" id="login" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –ª–æ–≥–∏–Ω" required>
            </div>

            <div class="form-group">
                <label class="required">–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞</label>
                <div class="button-group" id="platform-group">
                    <button type="button" data-value="iOS">iOS</button>
                    <button type="button" data-value="Android">Android</button>
                </div>
                <input type="hidden" id="platform" required>
            </div>

            <div class="form-group">
                <label class="required">–í–µ—Ä—Å–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</label>
                <input type="text" id="version" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 12.3.1" required>
            </div>

            <div class="form-group">
                <label class="required">–í—Ä–µ–º—è –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏—è –æ—à–∏–±–∫–∏</label>
                <input type="datetime-local" id="error_time" required>
            </div>

            <div class="form-group">
                <label class="required">–°–µ—Ä–≤–µ—Ä</label>
                <div class="button-group" id="server-group">
                    <button type="button" data-value="Corbina">Corbina</button>
                    <button type="button" data-value="Beeline">Beeline</button>
                </div>
                <input type="hidden" id="server" required>
            </div>

            <div class="form-group">
                <label>–õ–æ–≥–∏–Ω –∞–±–æ–Ω–µ–Ω—Ç–∞ / –ù–æ–º–µ—Ä –∑–∞—è–≤–∫–∏</label>
                <input type="text" id="subscriber" placeholder="–ü—Ä–∏ –Ω–∞–ª–∏—á–∏–∏">
                <div class="hint">–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ</div>
            </div>

            <div class="form-group">
                <label class="required">–û–ø–∏—Å–∞–Ω–∏–µ –æ—à–∏–±–∫–∏</label>
                <textarea id="description" placeholder="–û–ø–∏—à–∏—Ç–µ –æ—à–∏–±–∫—É –∏ –≤–∞—à–∏ –¥–µ–π—Å—Ç–≤–∏—è" required></textarea>
            </div>

            <div class="form-group">
                <label>–°–∫—Ä–∏–Ω—à–æ—Ç—ã / –í–∏–¥–µ–æ</label>
                <div class="file-upload">
                    <input type="file" id="media" accept="image/*,video/*" multiple>
                    <div class="file-upload-icon">üìé</div>
                    <div class="file-upload-text">–ù–∞–∂–º–∏—Ç–µ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ (–¥–æ 10 —Ñ–∞–π–ª–æ–≤)</div>
                </div>
                <div id="file-error" class="file-error"></div>
                <div id="files-list" class="files-list"></div>
                <div id="files-counter" class="files-counter"></div>
                <div class="hint">–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ. –õ–∏–º–∏—Ç: 500MB –Ω–∞ —Ñ–∞–π–ª</div>
            </div>

            <div class="warning-banner">
                ‚ö†Ô∏è –ü–µ—Ä–µ–¥–∞—á–∞ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∑–∞–ø—Ä–µ—â–µ–Ω–∞
            </div>
        </form>
    </div>

    <div id="page-my-reports" class="page">
        <button class="back-btn" onclick="switchPage('form')">‚Üê –ù–∞–∑–∞–¥</button>
        <h1>–ú–æ–∏ —Ä–µ–ø–æ—Ä—Ç—ã</h1>

        <div id="my-loading" class="loading">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
        <div id="my-empty" class="empty-state" style="display: none;">
            <div class="empty-state-icon">üìã</div>
            <p>–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç —Ä–µ–ø–æ—Ä—Ç–æ–≤</p>
        </div>
        <div id="my-report-list" class="report-list"></div>
    </div>

    <div id="page-admin" class="page">
        <button class="back-btn" onclick="switchPage('form')">‚Üê –ù–∞–∑–∞–¥</button>
        <h1>–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</h1>

        <div id="admin-stats" class="stats" style="display: none;">
            <div class="stat-card">
                <div class="stat-value" id="stat-total">0</div>
                <div class="stat-label">–í—Å–µ–≥–æ</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="stat-open">0</div>
                <div class="stat-label">–ù–æ–≤—ã–µ</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="stat-progress">0</div>
                <div class="stat-label">–í —Ä–∞–±–æ—Ç–µ</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="stat-resolved">0</div>
                <div class="stat-label">–ó–∞–≤–µ—Ä—à–µ–Ω–æ</div>
            </div>
        </div>

        <div id="admin-toolbar" class="admin-toolbar" style="display: none;">
            <div class="search-row">
                <input type="text" id="admin-search-input" class="search-input" placeholder="–ü–æ–∏—Å–∫ –ø–æ –æ–ø–∏—Å–∞–Ω–∏—é, –ª–æ–≥–∏–Ω—É, –Ω–æ–º–µ—Ä—É...">
                <button class="search-btn" onclick="searchReports()">üîç</button>
            </div>
            <button class="export-btn" onclick="exportCSV()">üì• –≠–∫—Å–ø–æ—Ä—Ç CSV</button>
        </div>

        <div id="admin-filters" class="filters" style="display: none;">
            <button class="filter-btn active" data-status="">–í—Å–µ</button>
            <button class="filter-btn" data-status="new">–ù–æ–≤—ã–µ</button>
            <button class="filter-btn" data-status="revision">–î–æ—Ä–∞–±–æ—Ç–∫–∞</button>
            <button class="filter-btn" data-status="in_progress">–í —Ä–∞–±–æ—Ç–µ</button>
            <button class="filter-btn" data-status="completed">–ó–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–µ</button>
            <button class="filter-btn" data-status="trash">–û—Ç–∫–∞–∑</button>
        </div>

        <div id="admin-loading" class="loading">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
        <div id="admin-empty" class="empty-state" style="display: none;">
            <div class="empty-state-icon">üìã</div>
            <p>–ù–µ—Ç —Ä–µ–ø–æ—Ä—Ç–æ–≤</p>
        </div>
        <div id="admin-report-list" class="report-list"></div>
    </div>

    <div id="user-modal" class="modal-overlay">
        <div class="modal">
            <div class="modal-header">
                <span class="modal-title" id="user-modal-title">–†–µ–ø–æ—Ä—Ç</span>
                <button class="modal-close" onclick="closeUserModal()">&times;</button>
            </div>

            <div id="user-modal-error" class="modal-error"></div>

            <div class="detail-row">
                <div class="detail-label">–°—Ç–∞—Ç—É—Å</div>
                <div class="detail-value" id="user-detail-status">-</div>
            </div>

            <div class="detail-row" id="user-revision-comment-row" style="display: none;">
                <div class="detail-label">–ß—Ç–æ —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–æ—Ä–∞–±–æ—Ç–∞—Ç—å</div>
                <div class="detail-value" id="user-detail-comment" style="background-color: #fff3e0; padding: 12px; border-radius: 8px; color: #e65100;">-</div>
            </div>

            <div class="detail-row">
                <div class="detail-label">Tracking ID</div>
                <div class="detail-value" id="user-detail-tracking">-</div>
            </div>

            <div class="detail-row">
                <div class="detail-label">–í–∞—à –ª–æ–≥–∏–Ω</div>
                <input type="text" class="detail-input" id="user-detail-login" style="min-height: auto;">
            </div>

            <div class="detail-row">
                <div class="detail-label">–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞</div>
                <div class="button-group" id="user-platform-group">
                    <button type="button" class="platform-btn" data-value="iOS">iOS</button>
                    <button type="button" class="platform-btn" data-value="Android">Android</button>
                </div>
            </div>

            <div class="detail-row">
                <div class="detail-label">–í–µ—Ä—Å–∏—è</div>
                <input type="text" class="detail-input" id="user-detail-version" style="min-height: auto;">
            </div>

            <div class="detail-row">
                <div class="detail-label">–í—Ä–µ–º—è –æ—à–∏–±–∫–∏</div>
                <input type="text" class="detail-input" id="user-detail-time" style="min-height: auto;">
            </div>

            <div class="detail-row">
                <div class="detail-label">–°–µ—Ä–≤–µ—Ä</div>
                <div class="button-group" id="user-server-group">
                    <button type="button" class="server-btn" data-value="Corbina">Corbina</button>
                    <button type="button" class="server-btn" data-value="Beeline">Beeline</button>
                </div>
            </div>

            <div class="detail-row">
                <div class="detail-label">–õ–æ–≥–∏–Ω –∞–±–æ–Ω–µ–Ω—Ç–∞ / ‚Ññ –∑–∞—è–≤–∫–∏</div>
                <input type="text" class="detail-input" id="user-detail-subscriber" style="min-height: auto;">
            </div>

            <div class="detail-row">
                <div class="detail-label">–û–ø–∏—Å–∞–Ω–∏–µ</div>
                <textarea class="detail-input" id="user-detail-description" rows="4"></textarea>
            </div>

            <div class="detail-row">
                <div class="detail-label">–°–æ–∑–¥–∞–Ω</div>
                <div class="detail-value" id="user-detail-created">-</div>
            </div>

            <button class="save-btn" id="user-save-btn" onclick="saveUserReport()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è</button>
        </div>
    </div>

    <div id="admin-modal" class="modal-overlay">
        <div class="modal">
            <div class="modal-header">
                <span class="modal-title" id="admin-modal-title">–†–µ–ø–æ—Ä—Ç</span>
                <button class="modal-close" onclick="closeAdminModal()">&times;</button>
            </div>

            <div id="admin-modal-error" class="modal-error"></div>

            <div class="detail-row">
                <div class="detail-label">–ê–≤—Ç–æ—Ä</div>
                <div class="detail-value" id="admin-detail-user">-</div>
            </div>

            <div class="detail-row">
                <div class="detail-label">–°—Ç–∞—Ç—É—Å</div>
                <select class="detail-select" id="admin-detail-status" onchange="toggleRevisionComment()">
                    <option value="new">–ù–æ–≤–∞—è</option>
                    <option value="revision">–î–æ—Ä–∞–±–æ—Ç–∫–∞</option>
                    <option value="in_progress">–í —Ä–∞–±–æ—Ç–µ</option>
                    <option value="completed">–ó–∞–≤–µ—Ä—à–µ–Ω–∞</option>
                    <option value="trash">–û—Ç–∫–∞–∑</option>
                </select>
            </div>

            <div class="detail-row" id="revision-comment-row" style="display: none;">
                <div class="detail-label">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π (—á—Ç–æ –¥–æ—Ä–∞–±–æ—Ç–∞—Ç—å)</div>
                <textarea class="detail-input" id="admin-detail-comment" placeholder="–£–∫–∞–∂–∏—Ç–µ, —á—Ç–æ —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–æ—Ä–∞–±–æ—Ç–∞—Ç—å..." rows="3"></textarea>
            </div>

            <div class="detail-row">
                <div class="detail-label">Tracking ID</div>
                <input type="text" class="detail-input" id="admin-detail-tracking" placeholder="–í–≤–µ–¥–∏—Ç–µ ID –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è" style="min-height: auto;">
            </div>

            <div class="detail-row">
                <div class="detail-label">–õ–æ–≥–∏–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</div>
                <div class="detail-value" id="admin-detail-login">-</div>
            </div>

            <div class="detail-row">
                <div class="detail-label">–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞</div>
                <div class="detail-value" id="admin-detail-platform">-</div>
            </div>

            <div class="detail-row">
                <div class="detail-label">–í–µ—Ä—Å–∏—è</div>
                <div class="detail-value" id="admin-detail-version">-</div>
            </div>

            <div class="detail-row">
                <div class="detail-label">–í—Ä–µ–º—è –æ—à–∏–±–∫–∏</div>
                <div class="detail-value" id="admin-detail-time">-</div>
            </div>

            <div class="detail-row">
                <div class="detail-label">–°–µ—Ä–≤–µ—Ä</div>
                <div class="detail-value" id="admin-detail-server">-</div>
            </div>

            <div class="detail-row">
                <div class="detail-label">–õ–æ–≥–∏–Ω –∞–±–æ–Ω–µ–Ω—Ç–∞ / ‚Ññ –∑–∞—è–≤–∫–∏</div>
                <div class="detail-value" id="admin-detail-subscriber">-</div>
            </div>

            <div class="detail-row">
                <div class="detail-label">–û–ø–∏—Å–∞–Ω–∏–µ</div>
                <div class="detail-value" id="admin-detail-description" style="white-space: pre-wrap;">-</div>
            </div>

            <div class="detail-row">
                <div class="detail-label">–°–æ–∑–¥–∞–Ω</div>
                <div class="detail-value" id="admin-detail-created">-</div>
            </div>

            <button class="save-btn" id="admin-save-btn" onclick="saveAdminReport()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        </div>
    </div>

    <script src="/static/js/app.js?v=7"></script>
</body>
</html>
